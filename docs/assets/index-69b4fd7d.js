var w=Object.defineProperty;var E=(r,e,t)=>e in r?w(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var h=(r,e,t)=>(E(r,typeof e!="symbol"?e+"":e,t),t),y=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var d=(r,e,t)=>(y(r,e,"read from private field"),t?t.call(r):e.get(r)),g=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},_=(r,e,t,i)=>(y(r,e,"write to private field"),i?i.call(r,t):e.set(r,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function $(r,e){let t=0;return function(...i){const s=Date.now();if(!(s-t<e))return t=s,r(...i)}}var u,c,f;class b extends HTMLElement{constructor(){super();h(this,"_size");h(this,"_prizes_dom");h(this,"_trigger_dom");h(this,"_playing");h(this,"_old_dge",0);h(this,"_transitionDuration",5e3);g(this,u,void 0);g(this,c,void 0);g(this,f,void 0)}connectedCallback(){this.style.display="block",this.style.position="relative",this._size=Math.min(this.offsetWidth,this.offsetHeight),this._prizes_dom=this.querySelector('[title*="prizes"]'),this._trigger_dom=this.querySelector('[title*="trigger"]'),this.relayout(),_(this,f,new ResizeObserver(([t])=>{if(this._playing===!0)return;const i=t.target;this._size=Math.min(i.offsetWidth,this.offsetHeight),this._playing=!1,this.relayout()})),d(this,f).observe(this),_(this,u,new MutationObserver(t=>{this._playing!==!0&&t.forEach(i=>{i.type==="childList"&&this.relayout()})})),d(this,u).observe(this._prizes_dom,{attributes:!0,childList:!0,subtree:!0}),_(this,c,new MutationObserver($(([t])=>{t.type==="attributes"&&this.handleAttributes(t.attributeName)},200))),d(this,c).observe(this,{childList:!1,attributes:!0}),this.handleLoad()}disconnectedCallback(){d(this,u).disconnect(),d(this,c).disconnect(),d(this,f).disconnect()}handleAttributes(t){this._playing!==!0&&t==="prize"&&this.lotter()}handleEnded(t){this.dispatchEvent(new CustomEvent("ended",{bubbles:!0,composed:!0,detail:t}))}handlePlay(t){this.dispatchEvent(new CustomEvent("play",{bubbles:!0,composed:!0,detail:t}))}handleLoad(){this.dispatchEvent(new CustomEvent("load",{bubbles:!0,composed:!0}))}lotter(){const t=this.getAttribute("prize");if(t){this._playing=!0,this.handlePlay(t);const i=Array.from(this._prizes_dom.children);let s;if(i.some((z,v)=>{z.getAttribute("title")===t&&(s=v)}),s===void 0)throw this._playing=!1,new Error("Unable to locate the prize element!");const a=360/i.length,p=`${this._transitionDuration}ms`,l=6;let n=a*s*-1;n+=360*l,n=n+this._old_dge,this._old_dge=(n-n%360)%360,this._prizes_dom.style.transitionDuration=p,this._prizes_dom.style.transform=`rotate(${n}deg)`;const m=()=>{this._prizes_dom.style.transitionDuration="0s",this._prizes_dom.style.transform=`rotate(${n%360}deg)`,this.handleEnded(t),this._prizes_dom.removeEventListener("transitionend",m),this._playing=!1};this._prizes_dom.addEventListener("transitionend",m)}}relayout(){this.relayoutPrizes(),this.relayoutTrigger()}relayoutPrizes(){if(!this._prizes_dom)return;const t=this._prizes_dom.style;t.position="absolute",t.padding="0",t.margin="0",t.left="0",t.top="0",t.boxSizing="border-box",t.width="100%",t.height="100%",t.borderRadius=`${this._size}px`,t.overflow="hidden";const i=Array.from(this._prizes_dom.children),s=360/i.length/2;this._prizes_dom.style.transform=`rotate(${s%360}deg)`,i.forEach((o,a)=>{const p=o,l=p.style,n=Math.min(p.offsetHeight,p.offsetWidth);l.position="absolute",l.width=`${n}px`,l.height=`${n}px`,l.left=`${this._size/2-n/2}px`,l.top=`${this._size/2-n/2}px`,l.transform=`translateY(${(this._size/2-n/2)*-1}px) rotate(${a*360/i.length}deg)`,l.transformOrigin=`${n/2}px ${this._size/2}px `})}relayoutTrigger(){if(!this._trigger_dom)return;const t=Math.min(this._trigger_dom.offsetHeight,this._trigger_dom.offsetWidth),i=this._trigger_dom.style;i.position="absolute",i.width=`${t}px`,i.height=`${t}px`,i.left=`${this._size/2-t/2}px`,i.top=`${this._size/2-t/2}px`}}u=new WeakMap,c=new WeakMap,f=new WeakMap,h(b,"default_props",Object.freeze({}));customElements.define("wc-wheel-lottery",b);
